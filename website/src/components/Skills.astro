---
import { Icon } from 'astro-icon/components';
import { t, tData } from '../i18n/utils';

interface Props {
  lang: string;
}

const { lang } = Astro.props;

interface SkillItem {
  name: string;
  icon: string;
  command: string;
  description: string;
  category: string;
}

interface Categories {
  gettingStarted: string;
  soundManagement: string;
  utilities: string;
}

const items = tData<SkillItem[]>('skills.items', lang);
const categories = tData<Categories>('skills.categories', lang);

const categoryConfig = [
  { key: 'gettingStarted' as const, icon: 'ph:rocket-launch' },
  { key: 'soundManagement' as const, icon: 'ph:music-notes' },
  { key: 'utilities' as const, icon: 'ph:wrench' },
];
---

<section id="skills" class="bg-misaek">
  <div class="py-24 md:py-32 lg:py-40 max-w-6xl mx-auto px-6 md:px-8 lg:px-12">
    <h2 class="text-(length:--text-h1) font-bold text-meok mb-4">
      {t('skills.heading', lang)}
    </h2>
    <p class="text-onggi text-lg mb-12">
      {t('skills.description', lang)}
    </p>

    {categoryConfig.map(({ key, icon }) => (
      <div class="mb-12 last:mb-0">
        <div class="flex items-center gap-2 mb-6">
          <Icon name={icon} class="w-5 h-5 text-hobak" />
          <h3 class="text-sm font-semibold text-hobak uppercase tracking-wider">
            {categories[key]}
          </h3>
        </div>

        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
          {items?.filter(item => item.category === key).map((item) => (
            <div class="reveal rounded-2xl bg-hanji p-4 md:p-6 border border-changho overflow-hidden">
              <div class="flex items-center gap-3 mb-3">
                <Icon name={item.icon} class="w-7 h-7 text-hobak shrink-0" />
                <h4 class="font-semibold text-meok">{item.name}</h4>
              </div>
              <p class="text-onggi text-sm leading-relaxed mb-4">{item.description}</p>
              <div class="flex items-center gap-2">
                <code class="flex-1 min-w-0 text-xs font-code bg-meok/5 dark:bg-meok/10 rounded-lg px-3 py-2 text-meok overflow-x-auto whitespace-nowrap scrollbar-hide">
                  {item.command}
                </code>
                <button
                  class="copy-btn shrink-0 w-8 h-8 rounded-lg bg-changho/80 dark:bg-changho/20 text-onggi hover:text-hobak hover:bg-hobak-soft flex items-center justify-center transition-all duration-200 cursor-pointer"
                  data-copy-text={item.command}
                  aria-label={t('common.copyToClipboard', lang)}
                  type="button"
                >
                  <Icon name="ph:copy" class="copy-icon w-4 h-4" />
                  <Icon name="ph:check-bold" class="check-icon w-4 h-4 hidden text-cheongja" />
                </button>
              </div>
            </div>
          ))}
        </div>
      </div>
    ))}
  </div>
</section>
